{% extends 'admin/base.html.twig' %}

{% block page_title %}Modération des Participations{% endblock %}

{% block body %}
<div class="d-flex justify-content-between mb-4">
    <h2>Liste des Participations</h2>
</div>

<div class="table-responsive">
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>ID</th>
                <th>Artiste</th>
                <th>Concours</th>
                <th>Œuvre</th>
                <th>Votes publics</th>
                <th>Note jury</th>
                <th>Date</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for participation in participations %}
            <tr>
                <td>{{ participation.id }}</td>
                <td><a href="{{ path('admin_artistes_show', {id: participation.artiste.id}) }}">{{ participation.artiste.getFullName }}</a></td>
                <td>{{ participation.concours.titre }}</td>
                <td>{{ participation.oeuvre ? participation.oeuvre.titre : '-' }}</td>
                <td>{{ participation.votesPublic }}</td>
                <td>{{ participation.noteJury ?? '-' }}</td>
                <td>{{ participation.createdAt|date('d/m/Y') }}</td>
                <td>
                    <div class="btn-group" role="group">
                        <a href="{{ path('admin_participations_show', {id: participation.id}) }}" class="btn btn-sm btn-info">
                            <i class="bi bi-eye"></i>
                        </a>
                        <form method="POST" action="{{ path('admin_participations_accept', {id: participation.id}) }}" class="d-inline">
                            <input type="hidden" name="_token" value="{{ csrf_token('accept_participation' ~ participation.id) }}">
                            <button type="submit" class="btn btn-sm btn-success">
                                <i class="bi bi-check-circle"></i>
                            </button>
                        </form>
                        <form method="POST" action="{{ path('admin_participations_reject', {id: participation.id}) }}" class="d-inline">
                            <input type="hidden" name="_token" value="{{ csrf_token('reject_participation' ~ participation.id) }}">
                            <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Êtes-vous sûr de vouloir refuser cette participation ?')">
                                <i class="bi bi-x-circle"></i>
                            </button>
                        </form>
                    </div>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="8" class="text-center">Aucune participation trouvée</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}



